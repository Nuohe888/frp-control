var p=(l,d,o)=>new Promise((r,u)=>{var s=e=>{try{n(o.next(e))}catch(i){u(i)}},m=e=>{try{n(o.throw(e))}catch(i){u(i)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(s,m);n((o=o.apply(l,d)).next())});import{p as _,a as h}from"./node-hUzDsXOU.js";import{u as w}from"./form-BUp9oLlJ.js";import{a_ as N,a4 as D,P as f,J as g,aa as A,ab as C,ac as F,x as I,a7 as v}from"../jse/index-index-DnPbrghU.js";import{bK as P}from"./bootstrap-B4JiwaAL.js";import{u as x}from"./use-modal-CbDtZeLz.js";function y(){return[{component:"Input",fieldName:"name",label:"名称",rules:"required"},{component:"Input",fieldName:"ip",label:"IP",rules:"required"},{component:"Input",fieldName:"password",label:"Password"},{component:"Input",fieldName:"desc",label:"Desc"},{component:"RadioGroup",componentProps:{buttonStyle:"solid",options:[{label:"启用",value:1},{label:"禁用",value:0}],optionType:"button"},defaultValue:1,fieldName:"status",label:"状态"}]}function H(){return[{field:"name",title:"角色名称"},{field:"ip",title:"IP"},{field:"password",title:"Password"},{field:"desc",title:"Desc"},{field:"status",title:"状态"},{field:"createdAt",title:"创建时间",formatter:({cellValue:l})=>l?N(l).format("YYYY-MM-DD HH:mm:ss"):""},{align:"center",fixed:"right",title:"操作",slots:{default:"action"}}]}const O=D({__name:"form",emits:["success"],setup(l,{emit:d}){const o=d,r=f(),[u,s]=w({schema:y(),showDefaultActions:!1}),m=()=>p(null,null,function*(){const{valid:a}=yield s.validate();if(!a)return;const t=yield s.getValues();c.lock(),(e.value?_(e.value,t):h(t)).then(()=>{o("success"),P.success(`${e.value?"更新":"创建"}成功`),c.close()}).catch(()=>{c.unlock()})}),n=a=>{if(a){const t=c.getData();s.resetForm(),t?(r.value=t,e.value=t.id,s.setValues(t)):e.value=void 0}},e=f(),[i,c]=x({destroyOnClose:!0,onConfirm:m,onOpenChange:n}),b=g(()=>{var a;return(a=r.value)!=null&&a.id?"编辑角色":"创建角色"});return(a,t)=>(C(),A(v(i),{title:b.value},{default:F(()=>[I(v(u))]),_:1},8,["title"]))}});export{O as _,H as u};
