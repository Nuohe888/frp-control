var f=(l,m,o)=>new Promise((r,u)=>{var s=e=>{try{n(o.next(e))}catch(i){u(i)}},d=e=>{try{n(o.throw(e))}catch(i){u(i)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(s,d);n((o=o.apply(l,m)).next())});import{u as _}from"./form-BUp9oLlJ.js";import{p as h,a as g}from"./role-B1t5w_aH.js";import{a_ as C,a4 as D,P as p,J as x,aa as y,ab as A,ac as M,x as N,a7 as v}from"../jse/index-index-DnPbrghU.js";import{ch as V,bK as k}from"./bootstrap-B4JiwaAL.js";import{u as w}from"./use-modal-CbDtZeLz.js";function F(){return[{component:"Input",fieldName:"name",label:"角色名称",rules:"required"},{component:"Input",fieldName:"code",label:"角色编码",rules:"required"},{component:"RadioGroup",componentProps:{buttonStyle:"solid",options:[{label:"启用",value:1},{label:"禁用",value:0}],optionType:"button"},defaultValue:1,fieldName:"status",label:"状态"},{component:"Textarea",fieldName:"desc",label:"角色描述"}]}function H(){return[{field:"name",title:"角色名称"},{field:"code",title:"角色编码"},{cellRender:{name:"CellTag",options:V().getDictList("sys_gender")},field:"status",title:"状态"},{field:"desc",title:"角色描述"},{field:"createdAt",title:"创建时间",formatter:({cellValue:l})=>l?C(l).format("YYYY-MM-DD HH:mm:ss"):""},{align:"center",fixed:"right",title:"操作",slots:{default:"action"}}]}const I=D({__name:"form",emits:["success"],setup(l,{emit:m}){const o=m,r=p(),[u,s]=_({schema:F(),showDefaultActions:!1}),d=()=>f(null,null,function*(){const{valid:a}=yield s.validate();if(!a)return;const t=yield s.getValues();c.lock(),(e.value?h(e.value,t):g(t)).then(()=>{o("success"),k.success(`${e.value?"更新":"创建"}成功`),c.close()}).catch(()=>{c.unlock()})}),n=a=>{if(a){const t=c.getData();s.resetForm(),t?(r.value=t,e.value=t.id,s.setValues(t)):e.value=void 0}},e=p(),[i,c]=w({destroyOnClose:!0,onConfirm:d,onOpenChange:n}),b=x(()=>{var a;return(a=r.value)!=null&&a.id?"编辑角色":"创建角色"});return(a,t)=>(A(),y(v(i),{title:b.value},{default:M(()=>[N(v(u))]),_:1},8,["title"]))}});export{I as _,H as u};
