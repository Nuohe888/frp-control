var i=(e,a,r)=>new Promise((c,f)=>{var s=n=>{try{u(r.next(n))}catch(l){f(l)}},p=n=>{try{u(r.throw(n))}catch(l){f(l)}},u=n=>n.done?c(n.value):Promise.resolve(n.value).then(s,p);u((r=r.apply(e,a)).next())});import{bM as m,bK as F}from"./bootstrap-B4JiwaAL.js";import{u as g}from"./form-BUp9oLlJ.js";import{a_ as h,a4 as y,P as b,J as M,aa as N,ab as A,ac as I,x as U,a7 as v}from"../jse/index-index-DnPbrghU.js";import{u as w}from"./use-modal-CbDtZeLz.js";function V(e){return i(this,null,function*(){return m.get("/frp/user/list",{params:e})})}function x(e,a){return i(this,null,function*(){return m.put(`/frp/user/${e}`,a)})}function C(e){return i(this,null,function*(){return m.post("/frp/user",e)})}function G(e){return i(this,null,function*(){return m.delete(`/frp/user/${e}`)})}function D(){return[{component:"Input",fieldName:"uuid",label:"UUID",rules:"required"},{component:"Input",fieldName:"nickname",label:"昵称",rules:"required"},{component:"InputNumber",fieldName:"flow",label:"流量"},{component:"InputNumber",fieldName:"speed",label:"限速"},{component:"Input",fieldName:"note",label:"备注"},{component:"RadioGroup",componentProps:{buttonStyle:"solid",options:[{label:"启用",value:1},{label:"禁用",value:0}],optionType:"button"},defaultValue:1,fieldName:"status",label:"状态"}]}function H(){return[{field:"uuid",title:"UUID"},{field:"nickname",title:"昵称"},{field:"flow",title:"流量",formatter:({cellValue:e})=>{if(!e)return"";const a=e/(1024*1024);return a>=1024?`${(a/1024).toFixed(2)} GB`:`${a.toFixed(2)} MB`}},{field:"speed",title:"限速",formatter:({cellValue:e})=>e?e+"M":""},{field:"note",title:"备注"},{field:"status",title:"状态"},{field:"createdAt",title:"创建时间",formatter:({cellValue:e})=>e?h(e).format("YYYY-MM-DD HH:mm:ss"):""},{align:"center",fixed:"right",title:"操作",slots:{default:"action"}}]}const O=y({__name:"form",emits:["success"],setup(e,{emit:a}){const r=a,c=b(),[f,s]=g({schema:D(),showDefaultActions:!1}),p=()=>i(null,null,function*(){const{valid:o}=yield s.validate();if(!o)return;const t=yield s.getValues();d.lock(),(t.uuid?x(t.uuid,t):C(t)).then(()=>{r("success"),F.success(`${t.uuid?"更新":"创建"}成功`),d.close()}).catch(()=>{d.unlock()})}),u=o=>{if(o){const t=d.getData();s.resetForm(),t?(c.value=t,n.value=t.id,s.setValues(t)):n.value=void 0}},n=b(),[l,d]=w({destroyOnClose:!0,onConfirm:p,onOpenChange:u}),_=M(()=>{var o;return(o=c.value)!=null&&o.id?"编辑角色":"创建角色"});return(o,t)=>(A(),N(v(l),{title:_.value},{default:I(()=>[U(v(f))]),_:1},8,["title"]))}});export{O as _,G as d,V as g,H as u};
